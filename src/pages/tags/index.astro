---
import Base from "@/layouts/Base.astro";
import { getAllTaxonomy } from "@/lib/taxonomyParser.astro";
import { humanize } from "@/lib/utils/textConverter";
import { FaHashtag } from "react-icons/fa";
const allTags = await getAllTaxonomy("posts", "tags");
const tagCountMap = allTags.reduce(
  (acc, tag) => {
    acc[tag] = (acc[tag] || 0) + 1;
    return acc;
  },
  {} as Record<string, number>
);
const tags = Object.entries(tagCountMap)
  .sort((a, b) => b[1] - a[1])
  .map(([tag]) => tag);
---

<Base title={"Tags"}>
  <section class="section">
    <div class="container">
      <h1 class="h2 page-heading">Tags</h1>
      <div class="row gy-3">
        {
          tags.map((tag) => (
            <div class="col-12 sm:col-6 lg:col-4">
              <a
                href={`/tags/${tag}`}
                class="group flex h-full items-center justify-between rounded-xl border border-border bg-light px-5 py-4 transition hover:-translate-y-0.5 hover:border-primary"
              >
                <span class="flex items-center">
                  <FaHashtag className="mr-2 text-primary transition group-hover:text-primary" />
                  <span class="font-semibold text-dark group-hover:text-primary">
                    {humanize(tag || "")}
                  </span>
                </span>
                <span class="text-sm font-semibold text-text">
                  {tagCountMap[tag]} {tagCountMap[tag] === 1 ? "post" : "posts"}
                </span>
              </a>
            </div>
          ))
        }
      </div>
    </div>
  </section>
</Base>
